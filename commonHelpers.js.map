{"version":3,"file":"commonHelpers.js","sources":["../src/js/gallery.js","../src/js/searchPixabay.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.querySelector('.gallery');\n\nexport function showGallery(galleryItems){\n    const imgsMarkup = galleryItems.map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) => \n        `\n        <a class=\"gallery__link\" href=${largeImageURL}>\n            <div class=\"photo-card\">\n                <img class=\"gallery__image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n                <div class=\"info\">\n                    <p class=\"info-item\">\n                        <b>Likes</b>\n                        ${likes}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Views</b>\n                        ${views}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Comments</b>\n                        ${comments}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Downloads</b>\n                        ${downloads}\n                    </p>\n                </div>\n            </div>\n        </a>\n        `)\n        .join(\"\");\n\n    gallery.insertAdjacentHTML(\"beforeend\", imgsMarkup);\n\n    //Zoom images by click\n    let zoomedImg = new SimpleLightbox('.gallery__link', {\n            captionSelector: '.gallery__image',\n            captionsData:'alt',\n            captionDelay: 250,\n    });\n}\n\nexport function resetGallery() {\n    gallery.innerHTML = \"\";\n}","import axios from \"axios\";\nexport function search(request, page = 1){\n    const encodedRequest = encodeURIComponent(request).replace(/%20/g, '+');\n    if (encodedRequest.length <= 100) {\n        return axios.get('https://pixabay.com/api/',\n            {\n                params: {\n                    key: \"38056621-1e45eaa8a2746a320c832ca9a\",\n                    q: `${encodedRequest}`,\n                    image_type: \"photo\",\n                    orientation: \"horizontal\",\n                    safesearch: \"true\",\n                    per_page: \"40\",\n                    page:`${page}`\n\n                }\n            })\n            .then(function (response) {\n                return response.data;\n            })\n            .catch(function (error) {\n                console.log(error);\n                throw error;\n            });\n    } else {\n        throw new Error(\"Too much character in request\");\n    }\n}","\"use strict\"\nimport { showGallery, resetGallery } from \"./js/gallery\";\nimport { search } from \"./js/searchPixabay\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport throttle from \"lodash/throttle\";\n\nconst elements = {\n    request: document.querySelector(\"input[name=searchQuery]\"),\n    reqButton: document.querySelector(\"button[type=submit]\"),\n    guard: document.querySelector(\".gallery__guard\"),\n}\nconst options = {\n    root: null,\n    rootMargin: \"300px\",\n    threshold: 1.0,\n}\nconst observer = new IntersectionObserver(loadMore, options);\nlet page = 1;\nlet totalHits = 0;\n\nelements.reqButton.addEventListener(\"click\", downloadPhotoesHandler);\nelements.request.addEventListener(\"change\", throttle(resetGallery, 3000));\n\nobserver.observe(elements.guard);\n\nasync function downloadPhotoesHandler(event){\n    event.preventDefault();\n    await downloadPhotoes();\n    await iziToast.info({\n        message:`Hooray! We found ${totalHits} images.`,\n        position: 'topRight',\n    })\n}\n\nasync function downloadPhotoes(){\n    try{\n        let data = await search(elements.request.value, page);\n        if (data.hits.length){\n            showGallery(data.hits);\n            totalHits = data.totalHits;\n        } else {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again.',\n                position: 'topRight',\n              }); \n        }\n    } catch(error) {\n        iziToast.error({\n            message: `${error}`,\n            position: 'topRight',\n          });\n    }\n}\n\nfunction loadMore(entity){\n    entity.forEach(element => {\n       if (element.isIntersecting && totalHits > 1){\n        if (totalHits > (40 * page)){\n            page += 1;\n            downloadPhotoes();\n        } else {\n            iziToast.info({\n                message:\"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n        })  \n        }\n        \n       };\n    });\n}"],"names":["gallery","showGallery","galleryItems","imgsMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","resetGallery","search","request","page","encodedRequest","axios","response","error","elements","options","observer","loadMore","totalHits","downloadPhotoesHandler","throttle","event","downloadPhotoes","iziToast","data","entity","element"],"mappings":"swBAGA,MAAMA,EAAU,SAAS,cAAc,UAAU,EAE1C,SAASC,EAAYC,EAAa,CACrC,MAAMC,EAAaD,EAAa,IAAI,CAAC,CAAC,aAAAE,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IACtG;AAAA,wCACgCL;AAAA;AAAA,mDAEWD,WAAsBE;AAAA;AAAA;AAAA;AAAA,0BAI/CC;AAAA;AAAA;AAAA;AAAA,0BAIAC;AAAA;AAAA;AAAA;AAAA,0BAIAC;AAAA;AAAA;AAAA;AAAA,0BAIAC;AAAA;AAAA;AAAA;AAAA;AAAA,SAKjB,EACA,KAAK,EAAE,EAEZV,EAAQ,mBAAmB,YAAaG,CAAU,EAGlC,IAAIQ,EAAe,iBAAkB,CAC7C,gBAAiB,kBACjB,aAAa,MACb,aAAc,GAC1B,CAAK,CACL,CAEO,SAASC,GAAe,CAC3BZ,EAAQ,UAAY,EACxB,CC7CO,SAASa,EAAOC,EAASC,EAAO,EAAE,CACrC,MAAMC,EAAiB,mBAAmBF,CAAO,EAAE,QAAQ,OAAQ,GAAG,EACtE,GAAIE,EAAe,QAAU,IACzB,OAAOC,EAAM,IAAI,2BACb,CACI,OAAQ,CACJ,IAAK,qCACL,EAAG,GAAGD,IACN,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAU,KACV,KAAK,GAAGD,GAEX,CACjB,CAAa,EACA,KAAK,SAAUG,EAAU,CACtB,OAAOA,EAAS,IAChC,CAAa,EACA,MAAM,SAAUC,EAAO,CACpB,cAAQ,IAAIA,CAAK,EACXA,CACtB,CAAa,EAEL,MAAM,IAAI,MAAM,+BAA+B,CAEvD,CCpBA,MAAMC,EAAW,CACb,QAAS,SAAS,cAAc,yBAAyB,EACzD,UAAW,SAAS,cAAc,qBAAqB,EACvD,MAAO,SAAS,cAAc,iBAAiB,CACnD,EACMC,EAAU,CACZ,KAAM,KACN,WAAY,QACZ,UAAW,CACf,EACMC,EAAW,IAAI,qBAAqBC,EAAUF,CAAO,EAC3D,IAAIN,EAAO,EACPS,EAAY,EAEhBJ,EAAS,UAAU,iBAAiB,QAASK,CAAsB,EACnEL,EAAS,QAAQ,iBAAiB,SAAUM,EAASd,EAAc,GAAI,CAAC,EAExEU,EAAS,QAAQF,EAAS,KAAK,EAE/B,eAAeK,EAAuBE,EAAM,CACxCA,EAAM,eAAc,EACpB,MAAMC,EAAe,EACrB,MAAMC,EAAS,KAAK,CAChB,QAAQ,oBAAoBL,YAC5B,SAAU,UAClB,CAAK,CACL,CAEA,eAAeI,GAAiB,CAC5B,GAAG,CACC,IAAIE,EAAO,MAAMjB,EAAOO,EAAS,QAAQ,MAAOL,CAAI,EAChDe,EAAK,KAAK,QACV7B,EAAY6B,EAAK,IAAI,EACrBN,EAAYM,EAAK,WAEjBD,EAAS,MAAM,CACX,QAAS,2EACT,SAAU,UAC1B,CAAe,CAEV,OAAOV,EAAN,CACEU,EAAS,MAAM,CACX,QAAS,GAAGV,IACZ,SAAU,UACtB,CAAW,CACN,CACL,CAEA,SAASI,EAASQ,EAAO,CACrBA,EAAO,QAAQC,GAAW,CACnBA,EAAQ,gBAAkBR,EAAY,IACrCA,EAAa,GAAKT,GAClBA,GAAQ,EACRa,KAEAC,EAAS,KAAK,CACV,QAAQ,6DACR,SAAU,UAC1B,CAAS,EAIT,CAAK,CACL"}