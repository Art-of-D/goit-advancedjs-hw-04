{"version":3,"file":"commonHelpers.js","sources":["../src/js/gallery.js","../src/js/searchPixabay.js","../src/main.js"],"sourcesContent":["const gallery = document.querySelector('.gallery');\n\nexport function showGallery(galleryItems){\n    const imgsMarkup = galleryItems.map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) => \n        `\n        <a class=\"gallery__link\" href=${largeImageURL}>\n            <div class=\"photo-card\">\n                <img class=\"gallery__image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n                <div class=\"info\">\n                    <p class=\"info-item\">\n                        <b>Likes</b>\n                        ${likes}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Views</b>\n                        ${views}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Comments</b>\n                        ${comments}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Downloads</b>\n                        ${downloads}\n                    </p>\n                </div>\n            </div>\n        </a>\n        `)\n        .join(\"\");\n\n    gallery.insertAdjacentHTML(\"beforeend\", imgsMarkup);\n}\n\nexport function resetGallery() {\n    gallery.innerHTML = \"\";\n}","import axios from \"axios\";\nexport async function search(request, page = 1, photoPerPage = 40){\n    const encodedRequest = encodeURIComponent(request).replace(/%20/g, '+');\n    if (encodedRequest.length <= 100) {\n        return await axios.get('https://pixabay.com/api/',\n            {\n                params: {\n                    key: \"38056621-1e45eaa8a2746a320c832ca9a\",\n                    q: `${encodedRequest}`,\n                    image_type: \"photo\",\n                    orientation: \"horizontal\",\n                    safesearch: \"true\",\n                    per_page: JSON.stringify(photoPerPage),\n                    page:`${page}`\n\n                }\n            });\n    } else {\n        throw new Error(\"Too much character in request\");\n    }\n}","\"use strict\"\nimport { showGallery, resetGallery } from \"./js/gallery\";\nimport { search } from \"./js/searchPixabay\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport throttle from \"lodash/throttle\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst elements = {\n    request: document.querySelector(\"input[name=searchQuery]\"),\n    reqButton: document.querySelector(\"button[type=submit]\"),\n    guard: document.querySelector(\".gallery__guard\"),\n}\nlet zoomedImg = new SimpleLightbox('.gallery__link', {\n    captionSelector: '.gallery__image',\n    captionsData:'alt',\n    captionDelay: 250,\n});\nconst options = {\n    root: null,\n    rootMargin: \"300px\",\n    threshold: 1.0,\n}\nconst observer = new IntersectionObserver(loadMore, options);\nlet page = 1;\nlet totalHits = 0;\nconst photoPerPage = 40;\n\nelements.reqButton.addEventListener(\"click\", downloadPhotoesHandler);\nelements.request.addEventListener(\"change\", throttle(()=>{\n    resetGallery();\n    page = 1;\n    observer.unobserve(elements.guard);\n}\n    , 3000));\n\nasync function downloadPhotoesHandler(event){\n    event.preventDefault();\n    if (elements.request.value.trim()){\n        await downloadPhotoes();\n        await iziToast.info({\n            message:`Hooray! We found ${totalHits} images.`,\n            position: 'topRight',\n        });\n        await observer.observe(elements.guard);\n    } else {\n        iziToast.error({\n            message: \"Sorry, but you need to enter your request\",\n            position: 'topRight',\n          });\n    }\n    \n}\n\nasync function downloadPhotoes(){  \n    try{\n        const response = await search(elements.request.value, page, photoPerPage);\n        console.log(response);\n        if (response.data.hits.length){\n            showGallery(response.data.hits);\n            zoomedImg.refresh();\n            totalHits = response.data.totalHits;\n            \n        } else {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again.',\n                position: 'topRight',\n              }); \n        }\n    } catch(error) {\n        iziToast.error({\n            message: `${error}`,\n            position: 'topRight',\n          });\n    } \n    \n}\n\nfunction loadMore(entity){\n    entity.forEach(element => {\n       if (element.isIntersecting && totalHits > 1){\n        if (totalHits > (photoPerPage * page)){\n            page += 1;\n            downloadPhotoes();\n        } else {\n            iziToast.info({\n                message:\"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n        });\n            observer.unobserve(elements.guard);  \n        }\n        \n       };\n    });\n}"],"names":["gallery","showGallery","galleryItems","imgsMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","resetGallery","search","request","page","photoPerPage","encodedRequest","axios","elements","zoomedImg","SimpleLightbox","options","observer","loadMore","totalHits","downloadPhotoesHandler","throttle","event","downloadPhotoes","iziToast","response","error","entity","element"],"mappings":"2wBAAA,MAAMA,EAAU,SAAS,cAAc,UAAU,EAE1C,SAASC,EAAYC,EAAa,CACrC,MAAMC,EAAaD,EAAa,IAAI,CAAC,CAAC,aAAAE,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IACtG;AAAA,wCACgCL;AAAA;AAAA,mDAEWD,WAAsBE;AAAA;AAAA;AAAA;AAAA,0BAI/CC;AAAA;AAAA;AAAA;AAAA,0BAIAC;AAAA;AAAA;AAAA;AAAA,0BAIAC;AAAA;AAAA;AAAA;AAAA,0BAIAC;AAAA;AAAA;AAAA;AAAA;AAAA,SAKjB,EACA,KAAK,EAAE,EAEZV,EAAQ,mBAAmB,YAAaG,CAAU,CACtD,CAEO,SAASQ,GAAe,CAC3BX,EAAQ,UAAY,EACxB,CCnCO,eAAeY,EAAOC,EAASC,EAAO,EAAGC,EAAe,GAAG,CAC9D,MAAMC,EAAiB,mBAAmBH,CAAO,EAAE,QAAQ,OAAQ,GAAG,EACtE,GAAIG,EAAe,QAAU,IACzB,OAAO,MAAMC,EAAM,IAAI,2BACnB,CACI,OAAQ,CACJ,IAAK,qCACL,EAAG,GAAGD,IACN,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAU,KAAK,UAAUD,CAAY,EACrC,KAAK,GAAGD,GAEX,CACjB,CAAa,EAEL,MAAM,IAAI,MAAM,+BAA+B,CAEvD,CCXA,MAAMI,EAAW,CACb,QAAS,SAAS,cAAc,yBAAyB,EACzD,UAAW,SAAS,cAAc,qBAAqB,EACvD,MAAO,SAAS,cAAc,iBAAiB,CACnD,EACA,IAAIC,EAAY,IAAIC,EAAe,iBAAkB,CACjD,gBAAiB,kBACjB,aAAa,MACb,aAAc,GAClB,CAAC,EACD,MAAMC,EAAU,CACZ,KAAM,KACN,WAAY,QACZ,UAAW,CACf,EACMC,EAAW,IAAI,qBAAqBC,EAAUF,CAAO,EAC3D,IAAIP,EAAO,EACPU,EAAY,EAChB,MAAMT,EAAe,GAErBG,EAAS,UAAU,iBAAiB,QAASO,CAAsB,EACnEP,EAAS,QAAQ,iBAAiB,SAAUQ,EAAS,IAAI,CACrDf,IACAG,EAAO,EACPQ,EAAS,UAAUJ,EAAS,KAAK,CACrC,EACM,GAAI,CAAC,EAEX,eAAeO,EAAuBE,EAAM,CACxCA,EAAM,eAAc,EAChBT,EAAS,QAAQ,MAAM,KAAI,GAC3B,MAAMU,EAAe,EACrB,MAAMC,EAAS,KAAK,CAChB,QAAQ,oBAAoBL,YAC5B,SAAU,UACtB,CAAS,EACD,MAAMF,EAAS,QAAQJ,EAAS,KAAK,GAErCW,EAAS,MAAM,CACX,QAAS,4CACT,SAAU,UACtB,CAAW,CAGX,CAEA,eAAeD,GAAiB,CAC5B,GAAG,CACC,MAAME,EAAW,MAAMlB,EAAOM,EAAS,QAAQ,MAAOJ,EAAMC,CAAY,EACxE,QAAQ,IAAIe,CAAQ,EAChBA,EAAS,KAAK,KAAK,QACnB7B,EAAY6B,EAAS,KAAK,IAAI,EAC9BX,EAAU,QAAO,EACjBK,EAAYM,EAAS,KAAK,WAG1BD,EAAS,MAAM,CACX,QAAS,2EACT,SAAU,UAC1B,CAAe,CAEV,OAAOE,EAAN,CACEF,EAAS,MAAM,CACX,QAAS,GAAGE,IACZ,SAAU,UACtB,CAAW,CACN,CAEL,CAEA,SAASR,EAASS,EAAO,CACrBA,EAAO,QAAQC,GAAW,CACnBA,EAAQ,gBAAkBT,EAAY,IACrCA,EAAaT,EAAeD,GAC5BA,GAAQ,EACRc,MAEAC,EAAS,KAAK,CACV,QAAQ,6DACR,SAAU,UAC1B,CAAS,EACGP,EAAS,UAAUJ,EAAS,KAAK,GAI7C,CAAK,CACL"}